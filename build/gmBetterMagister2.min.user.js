// ==UserScript==
// @name 	BetterMagister2
// @namespace 	betterSgaMagisterNet2
// @description Verbeter de normale Magister 6
// @include 	https://*.magister.net/*
// @require  http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js
// @require https://rawgit.com/lightswitch05/table-to-json/master/lib/jquery.tabletojson.min.js
// @author 	Wouter Damen
// @version 	v1.13
// @grant 	GM_addStyle
// @grant	GM_setValue
// @grant	GM_getValue
// ==/UserScript==
var a="v1.13",e=function(){GM_addStyle(" .settings-Setup-widget { height: 100%; width: 100%; background-color: rgba(0, 0, 0, 0.67); position: absolute; z-index: 999999; } .settings-Setup-widget .block { width: 500px; margin: auto; background-color: #FFF; margin-top: 100px; border: 1px solid #111; } .settings-Setup-widget .endlink { text-transform: none; } .settings-Setup-widget .endlink p { float: left; padding-left: 5px; } .settings-Setup-widget fieldset { color: #FFF; font-size: 15px; } .settings-Setup-form label { font-size: 1rem; font-weight: unset; padding-bottom: 0px !important; padding-left: 0px !important; } .settings-Setup-form select { font-size: 0.8rem !important; padding: 0.2rem; width: 140; margin-bottom: 5px; } .settings-Setup-widget button { margin-top: 0.1rem; margin-bottom: 10px; } #styleVersion { padding: 0 8px 8px 8px !important; } .settings-Setup-widget h3 { padding-top: 5px !important; font-weight: bold !important; } .settings-Setup-widget .content { height: auto !important; } .settings-Setup-form .checkbox-input label { font-size: 0.8rem; padding-left: 10px !important; } .settings-Setup-form h5 { color: #FFF; font-size: 1rem; } .settings-Setup-form .checkbox-input input[type=\"checkbox\"]:checked + label span::after { position: relative !important; }"),$('<div class="settings-Setup-widget"><div class="block"><h3>BetterMagister Settings</h3><div class="content"><form class="settings-Setup-form"><label for="stylesheet">Stylesheet</label><p id="styleVersion"></p><select name="stylesheet" id="stylesheet"><option value="metro">Metro UI</option><option value="darkmode">Dark Mode</option><option value="defaultmode">Default</option></select></form><button>Opslaan</button></div><footer class="endlink"><p>BetterMagister '+a+"</p><a>sluiten</a></footer></div></div>").prependTo("body"),$('<label for="settings-Agenda">Agenda weergave</label><p style="padding: 0 8px 8px 8px !important">Verandert de agendaweergave automatisch</p><select name="settings-Agenda" id="settings-Agenda"><option value="lijst">Afsprakenlijst</option><option value="dag">Dagoverzicht</option><option value="week">Weekoverzicht</option><option value="werkweek">Werkweekoverzicht</option></select>').appendTo(".settings-Setup-form"),$('<label for="settings-Cijfers">Cijfer weergave</label><p style="padding: 0 8px 8px 8px !important">Wisselt automatisch tussen actieve cijferperiode of alle cijferperiodes.</p><select name="settings-Cijfers" id="settings-Cijfers"><option value="huidig">Huidige cijferperiode</option><option value="alle">Alle cijferperiodes</option></select>').appendTo(".settings-Setup-form"),$('<h5>Inloggen</h5><p style="padding: 0 8px 8px 8px !important">Alle wachtwoorden worden locaal en versleuteld opgeslagen.</p><div class="checkbox-input" id="login"><input class="ng-pristine ng-untouched ng-valid" name="rememberpw" data-ng-model="rememberUsername" id="rememberpw" tabindex="3" type="checkbox"><label for="rememberpw"><span></span>Wachtwoord onthouden</label><input class="ng-pristine ng-untouched ng-valid" name="autologin" data-ng-model="rememberUsername" id="autologin" tabindex="3" type="checkbox"><label for="autologin"><span></span>Automatisch Inloggen</label></div>').appendTo(".settings-Setup-form"),$(".settings-Setup-form select#stylesheet").val(GM_getValue("settings-Stylesheet","defaultmode")),$(".settings-Setup-form select#settings-Agenda").val(GM_getValue("settings-Agenda","lijst")),$(".settings-Setup-form select#settings-Cijfers").val(GM_getValue("settings-Cijfers","huidig")),$("#login > label:nth-child(2) > span:nth-child(1)").click(function(){$("#rememberpw").toggleClass("checked")}),$("#login > label:nth-child(4) > span:nth-child(1)").click(function(){$("#autologin").toggleClass("checked")}),GM_getValue("settings-Savepw",!1)&&$("#login > label:nth-child(2) > span:nth-child(1)").click(),GM_getValue("settings-autoLogin",!1)&&$("#login > label:nth-child(4) > span:nth-child(1)").click(),$(".settings-Setup-widget button").click(function(){GM_setValue("settings-Stylesheet",$(".settings-Setup-form select#stylesheet").val()),GM_setValue("settings-Agenda",$(".settings-Setup-form select#settings-Agenda").val()),GM_setValue("settings-Cijfers",$(".settings-Setup-form select#settings-Cijfers").val()),$("#rememberpw").hasClass("checked")?GM_setValue("settings-Savepw",!0):GM_setValue("settings-Savepw",!1),$("#autologin").hasClass("checked")?(GM_setValue("settings-autoLogin",!0),GM_setValue("settings-Savepw",!0)):GM_setValue("settings-autoLogin",!1),GM_setValue("settings-Setup",!1),$(".settings-Setup-widget").remove();var a=window.location.hash.split("?")[0];if("#/agenda"==a||"#/agenda/week"==a||"#/agenda/werkweek"==a||"#/agenda/dag"==a){var b=GM_getValue("settings-Agenda","lijst");"lijst"==b?window.location.hash="#/agenda":"dag"==b?window.location.hash="#/agenda/dag":"week"==b?window.location.hash="#/agenda/week":"werkweek"==b&&(window.location.hash="#/agenda/werkweek")}else window.location.reload()}),$(".settings-Setup-widget a").click(function(){$(".settings-Setup-widget").remove()})},f=function(a,b){var c=$('<div id="zesjescultuurWidget"><div class="block"><h3>Mutaties</h3><div class="content"><p id="vak"></p><p id="tot"></p><p id="weg"></p><p id="gem"></p></div><footer class="endlink"><a>Sluiten</a></footer></div></div>');GM_addStyle("#zesjescultuurWidget { height: 100%; width: 100%; background-color: rgba(0, 0, 0, 0.67); position: absolute; z-index: 999999;  } "),GM_addStyle("#zesjescultuurWidget .block { width: 500px; margin: auto; background-color: #FFF; margin-top: 100px; border: 1px solid #111; }"),GM_addStyle("#zesjescultuurWidget .block h3 { padding-top: 5px !important; }"),GM_addStyle('#vak::before { content: "Vak: "; } #tot::before { content: "Som Cijfers: "; } #weg::before { content: "Som Weging: "; } #gem::before { content: "Gemiddelde: "; }'),GM_addStyle("#zesjescultuurWidget .content { height: auto !important; }"),c.prependTo("body"),$("#vak").text(a),jQuery.each(b,function(a,b){b.Cijfer=Number(b.Cijfer.split(",")[0])+Number(b.Cijfer.split(",")[1])/10,b.Weging=Number(b.Weging)});var d=0,e=0;jQuery.each(b,function(a,b){d+=b.Cijfer*b.Weging,e+=b.Weging});var f=d/e;$("#tot").text(d.toPrecision(4)),$("#weg").text(e),$("#gem").text(f.toPrecision(3)),$("#zesjescultuurWidget .endlink a").click(function(){c.remove()}),GM_addStyle("#nieuwCijfer { width: 90%; margin: auto; } "),GM_addStyle("#nieuwCijfer p { width: 8%; float: left; padding: 4px 0 0 0; }"),GM_addStyle("#nieuwCijfer input::-moz-placeholder { color: #000; }"),GM_addStyle("#weging { margin-bottom: 2px; } #gemiddelde { width: 46%; float: left; } #cijfer { width: 46%; float: right; }"),$('<div id="nieuwCijfer"><form><input id="weging" type="text" placeholder="Weging (bv. 4)"><input id="gemiddelde" type="text" placeholder="Doel gemiddelde (bv. 7.5)"><p>of</p><input id="cijfer" type="text" placeholder="Cijfer (bv. 8.9)"></form></div>').appendTo("#zesjescultuurWidget .content"),GM_addStyle("#bereken { margin: 4px 4px 4px 4px; }"),$('<button id="bereken">Bereken</button>').appendTo("#zesjescultuurWidget .content"),$('<p id="error" style="color: red"></p>').appendTo("#zesjescultuurWidget .content"),$("#gemiddelde").change(function(){$("#cijfer").val("")}),$("#cijfer").change(function(){$("#gemiddelde").val("")}),$("#bereken").click(function(){if(""!=$("#weging").val()&&(""!=$("#gemiddelde").val()||""!=$("#cijfer").val()))if("NaN"==Number($("#weging").val()).toString())$("#error").text('Error: "Cijfer" is geen nummer (hint: Gebruik voor een komma een .; "4.1" ipv "4,1")');else if(""!=$("#gemiddelde").val()&&"NaN"==Number($("#gemiddelde").val()).toString())$("#error").text('Error: "Cijfer" is geen nummer (hint: Gebruik voor een komma een .; "4.1" ipv "4,1")');else if(""!=$("#cijfer").val()&&"NaN"==Number($("#cijfer").val()).toString())$("#error").text('Error: "Cijfer" is geen nummer (hint: Gebruik voor een komma een .; "4.1" ipv "4,1")');else if($("#error").text(""),""!=$("#gemiddelde").val()){var a=Number($("#gemiddelde").val()),b=Number($("#weging").val()),c=(a*(e+b)-d)/b;$("<p>Cijfer dat je moet halen om "+a+" te staan: "+c.toPrecision(2)+"</p>").appendTo("#zesjescultuurWidget .content")}else if(""!=$("#cijfer").val()){var c=Number($("#cijfer").val()),b=Number($("#weging").val()),a=(d+c*b)/(e+b);$("<p>Nieuw gemiddelde: "+a.toPrecision(3)+"</p>").appendTo("#zesjescultuurWidget .content")}})},g=function(){$(".grade-gemiddelde").hide();var a=0;$(".gradeHeader").each(function(b){$(this).text().split("G-R").length>1&&(a=b)});var b=0,c=$(".k-selectable > tbody:nth-child(2) > tr > td:nth-child("+(a+3).toString()+") > span:nth-child(1)").length;$(".k-selectable > tbody:nth-child(2) > tr > td:nth-child("+(a+3).toString()+") > span:nth-child(1)").each(function(a){var d=$(this).text();return" "==d?void(c-=1):void(b+=Number(d.split(",")[0])+Number(d.split(",")[1])/100)});var d=b/c;gemiddeldePrec=d.toPrecision(3),$(".grade-gemiddelde .cijfer.gemiddelde").text(gemiddeldePrec.toString());var e=0,f=0;$(".grade").each(function(a){if(!$(this).hasClass("gemiddeldecolumn"))return $(this).hasClass("insufficient")?void f++:$(this).hasClass("empty")?void 0:void e++});var g=(e/(e+f)*100).toPrecision(3);$(".grade-gemiddelde .cijfer.percentage").text(g);var h=$("#periodeSelect").val();jQuery.each(h,function(a,b){h[a]=" P"+h[a]}),$(".grade-gemiddelde .subtitle").text("in"+h.toString());var i=0,j=0;$(".k-selectable > tbody:nth-child(2) > tr > td:nth-child("+(a+4).toString()+") > span:nth-child(1)").each(function(a){var b=$(this).text();if(" "!=b){var c=Number(b);c>6?j+=c-6:c<6&&(i+=6-c)}}),j>i?i=0:i>j&&(i-=j,$(".cijfer.compensatie").addClass("insufficient")),$(".grade-gemiddelde .cijfer.compensatie").text(i.toString()),$(".grade-gemiddelde").show(400)},h=function(){var a=setInterval(function(){if($("#cijferoverzichtgrid").length){if(clearInterval(a),"alle"==GM_getValue("settings-Cijfers","huidig"))var b=setTimeout(function(){$("#periodeSelect_taglist .k-button:last-child span:last-child").click()},1e3);var b=setTimeout(function(){if(!$(".k-selectable tbody").children().length){$('<div id="bmGeenCijfers" class="loading-overlay ng-isolate-scope"><div class="icon-no-data"><p class="no-items">Geen gegevens in de huidige selectie.</p></div></div>').prependTo(".content-container-cijfers");var a=setInterval(function(){$(".k-selectable tbody").children().length?($("#bmGeenCijfers").hide(),clearInterval(a)):($("#bmGeenCijfers").show(),clearInterval(a))},1e3)}$(".gemiddeldecolumn").bind("click",function(){$('<footer class="endlink"><a id="zesjescultuurLink">Mutaties berekenen</a></footer>').appendTo("#idBerekening .block"),$(".gemiddeldecolumn").unbind(),$("#idBerekening footer a").click(function(){var a=$("td.k-state-selected").parent().attr("data-uid"),b=$('tr[data-uid="'+a+'"] > td:nth-child(2) > span:nth-child(1)').text();f(b,$(".cijfer-berekend").tableToJSON())})}),$('<div class="grade-gemiddelde"><span class="cijfer gemiddelde"></span><span class="omschrijving">Gemiddelde</span></div>').appendTo(".content-container-cijfers"),$('<div class="grade-gemiddelde"><span class="cijfer percentage"></span><span class="omschrijving">Voldoendes</span><span class="subtitle"></span></div>').appendTo(".content-container-cijfers"),$('<div class="grade-gemiddelde"><span class="cijfer compensatie"></span><span class="omschrijving">Te Compenseren</span></div>').appendTo(".content-container-cijfers"),g(),$(".k-multiselect .k-button span:last-child, #aanmeldingenSelect_listbox .k-item").click(function(){b=setTimeout(function(){g()},2e3)})},2e3)}},1e3)},i=function(a){var b=setInterval(function(){$("#menuKnopAgenda").length&&("lijst"==a?$("#menuKnopAgenda").attr("href","#/agenda?trk=main-menu"):"dag"==a?$("#menuKnopAgenda").attr("href","#/agenda/dag"):"week"==a?$("#menuKnopAgenda").attr("href","#/agenda/week"):"werkweek"==a&&$("#menuKnopAgenda").attr("href","#/agenda/werkweek"),clearInterval(b))},100)},k=function(){$('<script type="text/javascript" src="https://rawgit.com/apeklets/BetterMagister/gh-pages/build/js/updateChecker.js"></script>').appendTo("head");var b=setInterval(function(){$(".toasts").length&&($('<script id="updateCheck" type="text/javascript">var bmVersion = '+a+"; if(bmVersion != BetterMagisterInfo.bmVersion) {updateAlert();}</script>").appendTo("head"),clearInterval(b))},1e3)},l=function(){var a=setInterval(function(){$(".text-input #password").length&&(GM_addStyle("#checkbox-rememberpw { margin-top: 35px; }"),GM_addStyle(".account .checkbox-input { height: 0px !important; }"),$('<div class="checkbox-input" id="checkbox-rememberpw"><input class="ng-pristine ng-untouched ng-valid" name="rememberpw" data-ng-model="rememberUsername" id="rememberpw" tabindex="3" type="checkbox"><label for="rememberpw"><span></span>Wachtwoord onthouden</label></div>').appendTo(".content fieldset"),GM_getValue("saved-Password",!1)!==!1&&(GM_getValue("settings-Savepw",!1)||GM_getValue("settings-autoLogin",!1))&&($("#password").val(GM_getValue("saved-Password","")),GM_getValue("settings-autoLogin",!1)?$("<script type=\"text/javascript\">$('#password').change(); $('.btn-primary3').click()</script>").appendTo("head"):$("<script type=\"text/javascript\">$('#password').change()</script>").appendTo("head")),(GM_getValue("settings-Savepw",!1)||GM_getValue("settings-autoLogin",!1))&&$('#checkbox-rememberpw input[type="checkbox"]').attr("checked","checked"),$(".btn-primary3").click(function(){1==$('#checkbox-rememberpw input[type="checkbox"]:checked').length?(GM_setValue("saved-Password",$(".text-input #password").val()),GM_setValue("settings-Savepw",!0)):GM_setValue("settings-Savepw",!1)}),clearInterval(a))},100)},m=function(){var a=setInterval(function(){if($(".content-container").length){clearInterval(a),GM_addStyle(".setup-Tour-widget { height: 100%; width: 100%; background-color: rgba(0, 0, 0, 0.67); position: absolute; z-index: 999999; }"),GM_addStyle(".setup-Tour-widget .block { width: 67%; height: auto; margin: auto; margin-top: 20px; overflow: hidden; }"),GM_addStyle(".setup-Tour-widget .block h3 { text-align: left; font-size: 18px !important; }"),GM_addStyle(".setup-Tour-widget .block .content { height: 600px; }"),GM_addStyle(".setup-Tour-widget .block .endlink { text-transform: none; }"),GM_addStyle(".setup-Tour-widget .block .endlink p {  }"),GM_addStyle(".setup-Tour-widget .block .endlink #stap { width: 100px; display: inline-block; }"),GM_addStyle("#welcome { padding-top: 250px;} #welcome h1 { opacity: 0; } #welcome p { opacity: 0; } #welcome .k-button { opacity: 0; margin: 2px; padding: 1px 11px 1px; } #welcome .k-button p { font-size: 18px; }"),GM_addStyle(" .endlink .k-button { margin: 2px; padding: 4px 11px 4px; display: inline-block; background-color: #0096db; border: 1px solid #0076db; width: 80px; color: #F2F2F2; }"),GM_addStyle(".setup-Tour-widget .content h1 { font-size: 3rem; font-weight: 600; }"),GM_addStyle(".setup-Tour-widget .content p { font-size: 1rem; line-height: 1; }"),GM_addStyle(".setup-Tour-widget .content .thumbnail { display: inline-block; padding: 4px; margin-left: 10px; margin-bottom: 20px; line-height: 1.42; background-color: #FFF; border: 1px solid #DDD; border-radius: 4px; }"),GM_addStyle(".setup-Tour-widget .content .thumbnail > img { margin-left: auto; margin-right: auto; display: block; height: auto; }"),GM_addStyle(".setup-Tour-widget .content .thumbnail .caption { padding: 9px; color: #333; }"),GM_addStyle(".setup-Tour-widget .content form { background-color: unset; }"),GM_addStyle(".setup-Tour-widget .content form select { font-size: 14px; }"),GM_addStyle(".setup-Page { opacity: 0 }"),GM_addStyle("#page1 .thumbnail > img, #page3 .thumbnail > img, #page4 .thumbnail > img, #page5 .thumbnail > img { width: 500px; }"),GM_addStyle("#page2 .thumbnail > img{ width: 350px; }"),$('<div class="setup-Tour-widget"><div class="block"><h3>BetterMagister Setup Tour</h3><div class="content"></div></div></div>').prependTo("body"),$('<div id="welcome"><h1 id="1">BetterMagister</h1><p id="1">Verbeter Magister 6</p><h1 id="2">Welkom</h1><p id="2">Deze tour zal je de features van BetterMagister laten zien.</p><div class="k-button"><p>Start</p></div></div>').appendTo(".setup-Tour-widget .block .content"),$("#welcome h1#1").animate({opacity:1},{queue:!1,duration:500}),$("#welcome").animate({"padding-top":"200px"},{queue:!1,duration:1e3}),$("#welcome p#1").animate({opacity:1},500);setTimeout(function(){$("#welcome h1#1, #welcome p#1").animate({opacity:0},{queue:!1,duration:400}).promise().then(function(){$("#welcome h1#1, #welcome p#1").remove(),$("#welcome h1#2, #welcome p#2").animate({opacity:1},500),$("#welcome .k-button, #welcome .k-button p").animate({opacity:1},600),$("#welcome div.k-button").click(function(){$("#welcome").remove(),$('<footer class="endlink"><div id="prev" class="k-button"><p>Vorige</p></div><div id="stap"><p>Stap 1/5</p></div><div id="next" class="k-button"><p>Volgende</p></div></footer>').appendTo(".setup-Tour-widget .block");var a={end:function(){f.Stylesheet=$("#setup-Stylesheet").val()},html:$('<div id="page1" class="setup-Page"><h1>Betere Layout</h1><p>Magister wordt veel overzichtelijker met een nieuwe look. BetterMagister biedt twee nieuwe stylesheets: \'Metro\', gebaseerd op Metro UI, de design filosofie van Windows 8 en 10, en \'Dark Mode\'. De twee stylesheets zijn erg vergelijkbaar maar de grijstinten zijn een beetje donkerder en meeste hoeken zijn niet afgerond bij Metro.</p><div class="thumbnail"><img src="https://rawgit.com/apeklets/BetterMagister/gh-pages/bin/img/darkmode-agenda.png"></img><div class="caption"><p>Agenda met de Darkmode stylesheet</p></div></div><div class="thumbnail"><img src="https://rawgit.com/apeklets/BetterMagister/gh-pages/bin/img/metro-agenda.png"></img><div class="caption"><p>Agenda met de Metro stylesheet</div></div><p>Je kunt nu een stylesheet kiezen, maar je kunt dit ook later nog doen of aanpassen.</p><form id="setup-Tour-stylesheet-form"><select id="setup-Stylesheet"><option value="defaultmode">Default</option><option value="darkmode">DarkMode</option><option value="metro">Metro UI</option></select></form><p>Klik op volgende om verder te gaan</p></div>'),id:"#page1"},b={end:function(){},html:$('<div id="page2" class="setup-Page"><h1>Zesjescultuur</h1><p>BetterMagister heeft een ingebouwde zesjescultuur functie, die automatisch veranderingen in je gemiddelde berekent. Hieronder een korte uitleg over het gebruik.</p><div class="thumbnail"><img src="https://rawgit.com/apeklets/BetterMagister/gh-pages/bin/img/zesjes-1.png"></img><div class="caption"><p>Klik op een van de berekende kolommen.</p></div></div><div class="thumbnail"><img src="https://rawgit.com/apeklets/BetterMagister/gh-pages/bin/img/zesjes-2.png"></img><div class="caption"><p>Klik in de sidebar op \'Mutaties Berekenen\'.</p></div></div><div class="thumbnail"><img src="https://rawgit.com/apeklets/BetterMagister/gh-pages/bin/img/zesjes-3.png"></img><div class="caption"><p>Hier kun je de gegevens invullen.</p></div></div></div>'),id:"#page2"},c={end:function(){f.Agenda=$("#setup-Agenda").val()},html:$('<div id="page3" class="setup-Page"><h1>Agendaweergave</h1><p>BetterMagister laat je de agendaweergave opslaan. Wat je normaal elke keer bij de \'Weergave\' tab moet veranderen.</p><div class="thumbnail"><img src="https://rawgit.com/apeklets/BetterMagister/gh-pages/bin/img/metro-agenda.png"></img><div class="caption"><p>Screenshot van de afsprakenlijst weergave</p></div></div><div class="thumbnail"><img src="https://rawgit.com/apeklets/BetterMagister/gh-pages/bin/img/metro-werkweek.png"></img><div class="caption"><p>Screenshot van de werkweekoverzicht weergave</p></div></div><p>Je kunt nu een weergave kiezen, maar je kunt dit ook later nog doen of aanpassen.</p><form><select id="#setup-Agenda"><option value="lijst">Afsprakenlijst</option><option value="dag">Dagoverzicht</option><option value="week">Weekoverzicht</option><option value="werkweek">Werkweekoverzicht</option></select></form></div>'),id:"#page3"},d={end:function(){$("#next p").text("Afronden")},html:$('<div id="page4" class="setup-Page"><h1>Wachtwoord onthouden</h1><p>BetterMagister laat je op de inlogpagina je wachtwoord onthouden, en kan je zelfs automatisch inloggen. Je wachtwoord wordt alleen versleuteld op je computer opgeslagen, en nergens anders.</p><div class="thumbnail"><img src="https://rawgit.com/apeklets/BetterMagister/gh-pages/bin/img/metro-loginscherm.png"></img><div class="caption"><p>Wachtwoord onthouden optie op de loginpagina.</p></div></div></div>'),id:"#page4"},e={end:function(){},html:$('<div id="page5" class="setup-Page"><h1>Instellingen opslaan</h1><p>Alle instellingen die in deze tour aan bot gekomen zijn, kun je aanpassen. De instellingenknop kun je naast je gebruikersnaam en profielfoto vinden, rechtsbovenin het scherm.</p><div class="thumbnail"><img src="https://rawgit.com/apeklets/BetterMagister/gh-pages/bin/img/metro-settingsbutton.png"></img><div class="caption"><p>De settings knop</p></div></div><div class="thumbnail"><img src="https://rawgit.com/apeklets/BetterMagister/gh-pages/bin/img/metro-settings.png"></img><div class="caption"><p>De settings pagina</p></div></div><p>Klik op Afronden om de tour te be&eumlindigen.</p></div>'),id:"#page5"},f={},g=[a,b,c,d,e],h=0,i=function(){return 4==h?(GM_setValue("settings-Stylesheet",f.Stylesheet),GM_setValue("settings-Agenda",f.Agenda),GM_setValue("setup-Tour",!1),void $(".setup-Tour-widget").remove()):(g[h].end(),$(".setup-Tour-widget .content").children().remove(),h++,g[h].html.appendTo(".setup-Tour-widget .content"),$(g[h].id).animate({opacity:1},500),$("#stap p").text("Stap "+(h+1).toString()+"/5"),void 0)},j=function(){4==h&&$("#next p").text("Volgende"),0!=h&&($(".setup-Tour-widget .content").children().remove(),h-=1,g[h].html.appendTo(".setup-Tour-widget .content"),$(g[h].id).animate({opacity:1},500),$("#stap p").text("Stap "+(h+1).toString()+"/5"))};a.html.appendTo(".setup-Tour-widget .content"),$(".setup-Page#page1").animate({opacity:1},500),$(".setup-Tour-widget .endlink #next").click(function(){i()}),$(".setup-Tour-widget .endlink #prev").click(function(){j()})})})},2e3)}},500)},n=function(){GM_addStyle(" .settings-Settings { border-left: 1px solid #666; position: relative; cursor: pointer; }"),GM_addStyle(" .settings-Settings:hover { background-color: #000 !important; }"),GM_addStyle(" .account .settings-Settings { display: none !important; }"),$('<div class="settings-Settings"><span class="icon-settings" style="color: red !important"></span></div>').appendTo(".header"),GM_getValue("setup-Tour",!0)&&"#/inloggen"!=window.location.href&&m(),"darkmode"==GM_getValue("settings-Stylesheet",!1)&&$('<link rel="stylesheet" href="https://rawgit.com/apeklets/BetterMagister/gh-pages/build/css/darkmode.min.css">').appendTo("head"),"metro"==GM_getValue("settings-Stylesheet",!1)&&$('<link rel="stylesheet" href="https://rawgit.com/apeklets/BetterMagister/gh-pages/build/css/metro.min.css">').appendTo("head"),"account"==$("body").attr("class")&&l(),$(".settings-Settings").click(function(){e()}),i(GM_getValue("settings-Agenda","lijst")),"#/cijfers"==window.location.hash?h():window.addEventListener("hashchange",function(){"#/cijfers"==window.location.hash&&h()}),"#/inloggen"!=window.location.hash&&k()};$(document).ready(n);